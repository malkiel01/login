/*
 * File: css/user-preferences.css
 * Version: 2.0.0
 * Created: 2026-01-23
 * Updated: 2026-01-25
 * Author: Malkiel
 * Description: תמיכה בהעדפות משתמש - ערכות צבע, מצב כהה, גודל פונט, מצב קומפקטי
 *
 * עקרון מרכזי: הכל עובד דרך CSS Variables!
 * כל ערכת צבע רק מגדירה variables, והרכיבים משתמשים בהם אוטומטית.
 */

/* ===================================================================
   1. BASE - משתנים בסיסיים
   =================================================================== */
:root {
    --base-font-size: 14px;
}

html {
    font-size: var(--base-font-size);
}

/* ===================================================================
   2. COLOR SCHEMES - ערכות צבע (מצב בהיר)
   רק מגדירים variables - אין overrides מפורשים!
   =================================================================== */

/* Purple (Default) */
[data-color-scheme="purple"],
body.color-scheme-purple {
    --primary-color: #667eea;
    --primary-dark: #764ba2;
}

/* Metallic Green */
[data-color-scheme="green"],
body.color-scheme-green {
    --primary-color: #059669;
    --primary-dark: #047857;
}

/* ===================================================================
   3. DARK MODE - ערכת צבעים כהה עצמאית
   עוקפת את ערכות הצבע הבהירות!
   =================================================================== */
html[data-theme="dark"],
html[data-theme="dark"] body,
body.dark-theme,
html[data-theme="dark"][data-color-scheme="green"],
html[data-theme="dark"][data-color-scheme="purple"],
body.dark-theme[data-color-scheme="green"],
body.dark-theme[data-color-scheme="purple"],
body.dark-theme.color-scheme-green,
body.dark-theme.color-scheme-purple {
    /* רקעים כהים */
    --bg-primary: #0f172a !important;
    --bg-secondary: #1e293b !important;
    --bg-tertiary: #334155 !important;

    /* טקסטים בהירים */
    --text-primary: #f1f5f9 !important;
    --text-secondary: #cbd5e1 !important;
    --text-muted: #94a3b8 !important;

    /* גבולות */
    --border-color: #475569 !important;

    /* צלליות */
    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.5);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.6);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.6);

    /* צבעים ראשיים - שחור-אפור */
    --primary-color: #374151 !important;
    --primary-dark: #1f2937 !important;
}

/* רקע גוף בדארק */
body.dark-theme {
    background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-primary) 100%) !important;
}

/* Header בדארק */
body.dark-theme .dashboard-header,
html[data-theme="dark"] .dashboard-header,
[data-theme="dark"] .dashboard-header {
    background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-primary) 100%) !important;
}

/* -------------------------------------------------------------------
   3.1 Dark Mode - רכיבים כלליים
   ------------------------------------------------------------------- */
[data-theme="dark"] .card,
[data-theme="dark"] .panel,
[data-theme="dark"] .sidebar,
[data-theme="dark"] .modal-content,
[data-theme="dark"] .popup-content,
body.dark-theme .card,
body.dark-theme .panel,
body.dark-theme .sidebar,
body.dark-theme .modal-content,
body.dark-theme .popup-content {
    background: var(--bg-secondary);
    border-color: var(--border-color);
}

body.dark-theme .dashboard-container,
body.dark-theme .dashboard-content,
body.dark-theme .main-content {
    background: var(--bg-primary);
}

/* -------------------------------------------------------------------
   3.2 Dark Mode - טבלאות
   ------------------------------------------------------------------- */
[data-theme="dark"] .table,
[data-theme="dark"] table,
body.dark-theme .table,
body.dark-theme table {
    background: var(--bg-secondary);
    color: var(--text-primary);
    font-size: 0.95rem;
    line-height: 1.4;
}

[data-theme="dark"] .table td,
[data-theme="dark"] table td,
body.dark-theme .table td,
body.dark-theme table td {
    font-size: 0.95rem;
    line-height: 1.4;
}

[data-theme="dark"] .table th,
[data-theme="dark"] table th,
body.dark-theme .table th,
body.dark-theme table th {
    background: var(--bg-tertiary);
    color: var(--text-primary);
    border-color: var(--border-color);
}

[data-theme="dark"] .table td,
[data-theme="dark"] table td,
body.dark-theme .table td,
body.dark-theme table td {
    border-color: var(--border-color);
    color: var(--text-primary);
}

[data-theme="dark"] .table tr:hover,
[data-theme="dark"] table tr:hover,
body.dark-theme .table tr:hover,
body.dark-theme table tr:hover {
    background: var(--bg-tertiary);
}

/* קישורים בטבלאות - לבן בהיר */
[data-theme="dark"] .table a,
[data-theme="dark"] table a,
[data-theme="dark"] .data-table a,
[data-theme="dark"] .tm-cell a,
[data-theme="dark"] td a,
[data-theme="dark"] .tm-row a,
body.dark-theme .table a,
body.dark-theme table a,
body.dark-theme .data-table a,
body.dark-theme .tm-cell a,
body.dark-theme td a,
body.dark-theme .tm-row a {
    color: #ffffff !important;
    font-weight: 700;
}

[data-theme="dark"] .table a:hover,
[data-theme="dark"] table a:hover,
[data-theme="dark"] td a:hover,
body.dark-theme .table a:hover,
body.dark-theme table a:hover,
body.dark-theme td a:hover {
    color: #f8fafc !important;
    text-decoration: underline;
}

/* -------------------------------------------------------------------
   3.3 Dark Mode - שדות קלט
   ------------------------------------------------------------------- */
[data-theme="dark"] input,
[data-theme="dark"] select,
[data-theme="dark"] textarea,
[data-theme="dark"] .form-control,
body.dark-theme input,
body.dark-theme select,
body.dark-theme textarea,
body.dark-theme .form-control {
    background: var(--bg-tertiary);
    border-color: var(--border-color);
    color: var(--text-primary);
}

[data-theme="dark"] input::placeholder,
[data-theme="dark"] textarea::placeholder,
body.dark-theme input::placeholder,
body.dark-theme textarea::placeholder {
    color: var(--text-muted);
}

/* -------------------------------------------------------------------
   3.4 Dark Mode - כפתורים
   ------------------------------------------------------------------- */
/* כפתורים משניים */
[data-theme="dark"] .btn-secondary,
[data-theme="dark"] .btn-outline,
body.dark-theme .btn-secondary,
body.dark-theme .btn-outline {
    background: var(--bg-tertiary);
    border-color: var(--border-color);
    color: var(--text-primary);
}

[data-theme="dark"] .btn-secondary:hover,
[data-theme="dark"] .btn-outline:hover,
body.dark-theme .btn-secondary:hover,
body.dark-theme .btn-outline:hover {
    background: var(--bg-primary);
}

/* כפתורים ראשיים - שחור-אפור עם גבול לבן */
[data-theme="dark"] .btn-primary,
body.dark-theme .btn-primary,
[data-theme="dark"] .btn-search-toggle,
[data-theme="dark"] .btn-show-search,
body.dark-theme .btn-search-toggle,
body.dark-theme .btn-show-search {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%) !important;
    color: #f9fafb !important;
    border: 1px solid rgba(255, 255, 255, 0.2) !important;
}

[data-theme="dark"] .btn-primary:hover,
body.dark-theme .btn-primary:hover,
[data-theme="dark"] .btn-search-toggle:hover,
[data-theme="dark"] .btn-show-search:hover,
body.dark-theme .btn-search-toggle:hover,
body.dark-theme .btn-show-search:hover {
    background: linear-gradient(135deg, #4b5563 0%, var(--primary-color) 100%) !important;
    border-color: rgba(255, 255, 255, 0.4) !important;
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.5);
}

[data-theme="dark"] .btn-search-toggle svg,
[data-theme="dark"] .btn-show-search svg,
body.dark-theme .btn-search-toggle svg,
body.dark-theme .btn-show-search svg {
    stroke: white !important;
}

/* -------------------------------------------------------------------
   3.5 Dark Mode - Sidebar
   ------------------------------------------------------------------- */
[data-theme="dark"] .sidebar,
[data-theme="dark"] .side-panel,
body.dark-theme .sidebar,
body.dark-theme .side-panel {
    background: var(--bg-secondary);
}

[data-theme="dark"] .sidebar-item:hover,
[data-theme="dark"] .nav-item:hover,
body.dark-theme .sidebar-item:hover,
body.dark-theme .nav-item:hover {
    background: var(--bg-tertiary);
}

[data-theme="dark"] .sidebar-item.active,
[data-theme="dark"] .nav-item.active,
body.dark-theme .sidebar-item.active,
body.dark-theme .nav-item.active {
    background: var(--primary-color);
    color: white;
}

/* Hierarchy items - לא אקטיבי */
[data-theme="dark"] .hierarchy-header,
body.dark-theme .hierarchy-header {
    background: var(--bg-secondary) !important;
    border-color: var(--bg-tertiary) !important;
    color: var(--text-muted) !important;
}

[data-theme="dark"] .hierarchy-header:hover:not(.disabled):not(.active),
body.dark-theme .hierarchy-header:hover:not(.disabled):not(.active) {
    background: var(--bg-tertiary) !important;
    border-color: var(--border-color) !important;
    color: var(--text-secondary) !important;
}

/* Hierarchy items - אקטיבי */
[data-theme="dark"] .hierarchy-header.active,
body.dark-theme .hierarchy-header.active {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%) !important;
    border-color: rgba(255, 255, 255, 0.2) !important;
    color: #ffffff !important;
    font-weight: 700 !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4) !important;
}

[data-theme="dark"] .hierarchy-header.active .hierarchy-title,
body.dark-theme .hierarchy-header.active .hierarchy-title {
    color: #ffffff !important;
    font-weight: 700 !important;
}

[data-theme="dark"] .hierarchy-header.active .hierarchy-icon,
body.dark-theme .hierarchy-header.active .hierarchy-icon {
    color: #f1f5f9 !important;
}

[data-theme="dark"] .hierarchy-header.active .hierarchy-count,
body.dark-theme .hierarchy-header.active .hierarchy-count {
    background: rgba(255, 255, 255, 0.2) !important;
    color: #f1f5f9 !important;
}

/* Home link בסיידבר */
[data-theme="dark"] .sidebar-home-link,
body.dark-theme .sidebar-home-link {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%) !important;
    border: 1px solid rgba(255, 255, 255, 0.2) !important;
}

[data-theme="dark"] .sidebar-home-link:hover,
body.dark-theme .sidebar-home-link:hover {
    background: linear-gradient(135deg, #4b5563 0%, var(--primary-color) 100%) !important;
    border-color: rgba(255, 255, 255, 0.4) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
}

/* -------------------------------------------------------------------
   3.6 Dark Mode - אחרים
   ------------------------------------------------------------------- */
[data-theme="dark"] .breadcrumb,
body.dark-theme .breadcrumb {
    background: var(--bg-secondary);
}

[data-theme="dark"] .hierarchy-card,
[data-theme="dark"] .stat-card,
[data-theme="dark"] .info-card,
body.dark-theme .hierarchy-card,
body.dark-theme .stat-card,
body.dark-theme .info-card {
    background: var(--bg-secondary);
    border-color: var(--border-color);
}

[data-theme="dark"] .dropdown-menu,
[data-theme="dark"] .select-dropdown,
body.dark-theme .dropdown-menu,
body.dark-theme .select-dropdown {
    background: var(--bg-secondary);
    border-color: var(--border-color);
}

[data-theme="dark"] .dropdown-item:hover,
body.dark-theme .dropdown-item:hover {
    background: var(--bg-tertiary);
}

[data-theme="dark"] .search-container,
[data-theme="dark"] .search-input,
body.dark-theme .search-container,
body.dark-theme .search-input {
    background: var(--bg-tertiary);
    border-color: var(--border-color);
    color: var(--text-primary);
}

[data-theme="dark"] .modal-overlay,
[data-theme="dark"] .popup-overlay,
body.dark-theme .modal-overlay,
body.dark-theme .popup-overlay {
    background: rgba(0, 0, 0, 0.7);
}

[data-theme="dark"] .badge,
body.dark-theme .badge {
    opacity: 0.9;
}

/* Scrollbar */
[data-theme="dark"] ::-webkit-scrollbar-track,
body.dark-theme ::-webkit-scrollbar-track {
    background: var(--bg-primary);
}

[data-theme="dark"] ::-webkit-scrollbar-thumb,
body.dark-theme ::-webkit-scrollbar-thumb {
    background: var(--bg-tertiary);
}

[data-theme="dark"] ::-webkit-scrollbar-thumb:hover,
body.dark-theme ::-webkit-scrollbar-thumb:hover {
    background: #64748b;
}

/* ===================================================================
   4. COMPACT MODE - מצב קומפקטי
   =================================================================== */
body.compact-mode {
    --base-font-size: 13px;
}

body.compact-mode .card,
body.compact-mode .panel {
    padding: 12px;
}

body.compact-mode .btn {
    padding: 0.4rem 0.8rem;
    font-size: 0.8rem;
}

body.compact-mode .btn-sm {
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
}

body.compact-mode h1 { font-size: 1.5rem; }
body.compact-mode h2 { font-size: 1.3rem; }
body.compact-mode h3 { font-size: 1.15rem; }
body.compact-mode h4 { font-size: 1rem; }

body.compact-mode .table th,
body.compact-mode .table td,
body.compact-mode table th,
body.compact-mode table td {
    padding: 6px 10px;
    font-size: 0.85rem;
}

body.compact-mode .sidebar {
    width: 200px;
}

body.compact-mode .header-stats {
    gap: 10px;
}

body.compact-mode .header-stat {
    padding: 6px 12px;
}

body.compact-mode .stat-value {
    font-size: 1.1rem;
}

body.compact-mode .form-group {
    margin-bottom: 0.75rem;
}

body.compact-mode .form-control {
    padding: 0.4rem 0.6rem;
    font-size: 0.85rem;
}

body.compact-mode .modal-content,
body.compact-mode .popup-content {
    padding: 15px;
}

/* ===================================================================
   5. SIDEBAR COLLAPSED - סיידבר מכווץ
   =================================================================== */
.sidebar.collapsed,
.side-panel.collapsed {
    width: 60px !important;
    min-width: 60px !important;
}

.sidebar.collapsed .sidebar-text,
.sidebar.collapsed .nav-text,
.sidebar.collapsed .menu-text,
.side-panel.collapsed .sidebar-text,
.side-panel.collapsed .nav-text,
.side-panel.collapsed .menu-text {
    display: none;
}

.sidebar.collapsed .sidebar-item,
.sidebar.collapsed .nav-item,
.side-panel.collapsed .sidebar-item,
.side-panel.collapsed .nav-item {
    justify-content: center;
    padding: 12px;
}

.sidebar.collapsed .sidebar-icon,
.sidebar.collapsed .nav-icon,
.side-panel.collapsed .sidebar-icon,
.side-panel.collapsed .nav-icon {
    margin: 0;
    font-size: 1.2rem;
}

.sidebar.collapsed .sidebar-header,
.side-panel.collapsed .sidebar-header {
    padding: 10px;
    justify-content: center;
}

.sidebar.collapsed .sidebar-logo-text,
.side-panel.collapsed .sidebar-logo-text {
    display: none;
}

body.sidebar-collapsed .main-content,
body.sidebar-collapsed .dashboard-content {
    margin-right: 60px;
}

/* Tooltip on hover */
.sidebar.collapsed .sidebar-item:hover::after,
.side-panel.collapsed .nav-item:hover::after {
    content: attr(data-title);
    position: absolute;
    right: 100%;
    top: 50%;
    transform: translateY(-50%);
    background: var(--bg-primary);
    color: var(--text-primary);
    padding: 6px 12px;
    border-radius: 4px;
    font-size: 0.85rem;
    white-space: nowrap;
    box-shadow: var(--shadow-md);
    z-index: 1000;
    margin-right: 10px;
}

/* ===================================================================
   6. TRANSITIONS - אנימציות
   =================================================================== */
body,
.sidebar,
.side-panel,
.card,
.table,
table,
input,
select,
textarea,
.btn,
.dashboard-header {
    transition: background-color 0.3s ease,
                background 0.3s ease,
                color 0.3s ease,
                border-color 0.3s ease,
                width 0.3s ease;
}

/* ===================================================================
   7. PRINT - הדפסה
   =================================================================== */
@media print {
    [data-theme="dark"],
    body.dark-theme {
        --bg-primary: #ffffff;
        --bg-secondary: #f8fafc;
        --bg-tertiary: #f1f5f9;
        --text-primary: #1e293b;
        --text-secondary: #475569;
        --border-color: #e2e8f0;
    }

    body.compact-mode {
        --base-font-size: 12px;
    }
}
