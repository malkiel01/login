<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>עיבוד PDF - הוספת טקסטים</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.9.155/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.9.155/pdf.worker.min.js';
    </script> -->
</head>
<body>
    <div class="main-container">
        <!-- צד שמאל - טפסים -->
        <div class="controls-section">
            <div class="container">
                <h1>📄 עיבוד קובץ PDF</h1>
                <p class="subtitle">העלה קובץ PDF והוסף טקסטים מותאמים אישית</p>
                
                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon">📤</div>
                    <div class="upload-text">לחץ כאן או גרור קובץ PDF</div>
                    <div class="upload-hint">קבצי PDF בלבד</div>
                    <input type="file" id="fileInput" accept=".pdf">
                </div>
                
                <div class="file-info" id="fileInfo">
                    <div class="file-name" id="fileName"></div>
                    <div class="file-size" id="fileSize"></div>
                </div>

                <div class="texts-container" id="textsContainer" style="display: none;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h3 style="color: #667eea; margin: 0;">טקסטים להוספה</h3>
                        <button type="button" id="addTextBtn" style="background: #10b981; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 0.9em;">
                            ➕ הוסף טקסט
                        </button>
                    </div>
                    
                    <div id="textsList">
                        <!-- טקסטים יתוספו כאן דינמית -->
                    </div>
                </div>
                
                <button class="btn" id="processBtn">עבד את הקובץ</button>
                
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <div>מעבד את הקובץ...</div>
                </div>
                
                <div class="error" id="error"></div>
                
                <div class="results" id="results">
                    <div class="results-header">
                        <h2>✅ הקובץ עובד בהצלחה!</h2>
                    </div>
                    <div class="results-content">
                        <div class="result-item">
                            <span class="result-label">מספר דפים:</span>
                            <span class="result-value" id="pageCount"></span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">רוחב הדף:</span>
                            <span class="result-value" id="pageWidth"></span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">גובה הדף:</span>
                            <span class="result-value" id="pageHeight"></span>
                        </div>

                        <button class="btn save-template-btn" id="saveTemplateBtn">
                            💾 שמור כתבנית
                        </button>

                        <button class="btn download-btn" id="downloadBtn">
                            💾 הורד את הקובץ המעובד
                        </button>
                        
                        <button class="btn delete-source-btn" id="deleteSourceBtn">
                            🗑️ מחק קובץ מקור מהשרת
                        </button>
                        
                        <button class="btn delete-processed-btn" id="deleteProcessedBtn">
                            🗑️ מחק קובץ מעובד מהשרת
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- צד ימין - תצוגה מקדימה -->
        
        <div class="preview-section" id="previewSection" style="display: none;">
            <div class="preview-header">
                <h3>תצוגה מקדימה</h3>
                
                <div class="preview-controls">
                    <div class="zoom-controls">
                        <span id="zoomOut" class="zoom-btn">🔍−</span>
                        <span id="zoomLevel">100%</span>
                        <span id="zoomIn" class="zoom-btn">🔍+</span>
                    </div>
                    
                    <div class="page-navigation" id="pageNav" style="display: none;">
                        <button id="prevPage">◀</button>
                        <span id="pageInfo">דף <span id="currentPage">1</span> מתוך <span id="totalPages">1</span></span>
                        <button id="nextPage">▶</button>
                    </div>
                </div>
            </div>

            <!-- <div class="preview-header">
                <h3>תצוגה מקדימה</h3>
                <div class="page-navigation" id="pageNav" style="display: none;">
                    <button id="prevPage">◀</button>
                    <span id="pageInfo">דף <span id="currentPage">1</span> מתוך <span id="totalPages">1</span></span>
                    <button id="nextPage">▶</button>
                </div>
            </div> -->
            <div class="preview-container" id="previewContainer">
                <canvas id="pdfCanvas"></canvas>
            </div>
        </div>
    </div>

    <!-- Modal for saving template -->
    <div class="modal" id="saveTemplateModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>💾 שמירת תבנית</h2>
                <p style="color: #666; font-size: 0.9em;">שמור את התבנית לשימוש חוזר</p>
            </div>
            <div class="modal-body">
                <label for="templateName">שם התבנית: *</label>
                <input type="text" id="templateName" placeholder="לדוגמה: תעודת פטירה" required>
                
                <label for="templateDescription">תיאור התבנית:</label>
                <textarea id="templateDescription" placeholder="תיאור קצר של התבנית (אופציונלי)"></textarea>
                
                <div class="modal-error" id="modalError"></div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-secondary" id="cancelSaveBtn">ביטול</button>
                <button class="modal-btn modal-btn-primary" id="confirmSaveBtn">שמור תבנית</button>
            </div>
        </div>
    </div>


    <script src="script.js"></script>
</body>
</html>